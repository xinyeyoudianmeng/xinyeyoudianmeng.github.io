<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>心理状态自查工具 - 社交情绪与行为模式</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4A90E2',
                        secondary: '#50C878',
                        neutral: '#F5F7FA',
                        dark: '#333333',
                        light: '#FFFFFF'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'soft': '0 4px 20px rgba(0, 0, 0, 0.05)',
                        'hover': '0 10px 30px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .transition-all-300 {
                transition: all 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
            }
        }
        
        body {
            background-color: #F5F7FA;
            background-image: 
                radial-gradient(at 80% 10%, rgba(74, 144, 226, 0.05) 0px, transparent 50%),
                radial-gradient(at 20% 90%, rgba(80, 200, 120, 0.05) 0px, transparent 50%);
            background-attachment: fixed;
        }
        
        .option-card {
            transition: all 0.3s ease;
        }
        
        .option-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .option-card.selected {
            border-color: #4A90E2;
            background-color: rgba(74, 144, 226, 0.05);
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        .result-card {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
        }
        
        .result-card.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="font-sans text-dark">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- 头部区域 -->
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-primary mb-4 text-shadow">心理状态自查工具</h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                这是一份原创的心理状态自查工具，帮助你了解自己在社交情绪和日常行为模式方面的状态。
                请诚实回答以下问题，结果仅供参考，非专业诊断。
            </p>
        </header>

        <!-- 免责声明 -->
        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-8 rounded-md shadow-soft">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fa fa-exclamation-triangle text-yellow-400 text-xl"></i>
                </div>
                <div class="ml-3">
                    <h3 class="text-lg font-medium text-yellow-800">重要提示</h3>
                    <div class="mt-2 text-sm text-yellow-700">
                        <p>本测试为<span class="font-bold">原创内容服务</span>，<span class="font-bold">非专业医疗/心理测评</span>。</p>
                        <p>测试结果仅供参考，不构成任何形式的诊断或治疗建议。</p>
                        <p>如有严重心理困扰，请寻求专业心理咨询师或医疗机构的帮助。</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 测试内容区域 -->
        <div id="test-container" class="bg-white rounded-xl shadow-soft p-6 mb-8">
            <!-- 测试类型选择 -->
            <div id="test-selection" class="mb-8">
                <h2 class="text-2xl font-bold mb-6 text-center">请选择测试类型</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 社交情绪自查 -->
                    <div class="bg-neutral rounded-lg p-6 shadow-soft card-hover cursor-pointer" onclick="startTest('social')">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mr-4">
                                <i class="fa fa-users text-primary text-xl"></i>
                            </div>
                            <h3 class="text-xl font-semibold">社交情绪自查</h3>
                        </div>
                        <p class="text-gray-600">基于社交焦虑量表(IAS)设计，评估你在社交场合中的焦虑程度和情绪体验。</p>
                        <div class="mt-4 text-sm text-gray-500">
                            <i class="fa fa-clock-o mr-1"></i> 约需5分钟完成
                        </div>
                    </div>
                    
                    <!-- 行为模式自查 -->
                    <div class="bg-neutral rounded-lg p-6 shadow-soft card-hover cursor-pointer" onclick="startTest('behavioral')">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full bg-secondary/10 flex items-center justify-center mr-4">
                                <i class="fa fa-mobile text-secondary text-xl"></i>
                            </div>
                            <h3 class="text-xl font-semibold">行为模式自查</h3>
                        </div>
                        <p class="text-gray-600">评估你在手机使用、游戏等日常行为方面的模式，帮助你关注健康的行为习惯。</p>
                        <div class="mt-4 text-sm text-gray-500">
                            <i class="fa fa-clock-o mr-1"></i> 约需5分钟完成
                        </div>
                    </div>
                </div>
            </div>

            <!-- 测试问题区域 -->
            <div id="test-questions" class="hidden">
                <!-- 进度条 -->
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-gray-700" id="question-progress">问题 1/10</span>
                        <span class="text-sm font-medium text-gray-700" id="test-timer">00:00</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="progress-bar" class="bg-primary h-2.5 rounded-full progress-bar" style="width: 10%"></div>
                    </div>
                </div>

                <!-- 问题 -->
                <div id="question-container" class="mb-8">
                    <h3 id="question-text" class="text-xl font-semibold mb-6"></h3>
                    <div id="options-container" class="space-y-4">
                        <!-- 选项将通过JS动态生成 -->
                    </div>
                </div>

                <!-- 导航按钮 -->
                <div class="flex justify-between">
                    <button id="prev-btn" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all-300 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        <i class="fa fa-arrow-left mr-2"></i>上一题
                    </button>
                    <button id="next-btn" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-all-300 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        下一题<i class="fa fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>

            <!-- 测试结果区域 -->
            <div id="test-results" class="hidden">
                <h2 class="text-2xl font-bold mb-6 text-center" id="result-title"></h2>
                
                <!-- 结果图表 -->
                <div class="mb-8">
                    <canvas id="result-chart" height="200"></canvas>
                </div>
                
                <!-- 结果解释 -->
                <div id="result-explanation" class="mb-8">
                    <h3 class="text-xl font-semibold mb-4">结果解读</h3>
                    <div id="result-text" class="text-gray-700 space-y-4"></div>
                </div>
                
                <!-- 建议 -->
                <div id="result-suggestions" class="mb-8">
                    <h3 class="text-xl font-semibold mb-4">温馨建议</h3>
                    <ul id="suggestions-list" class="list-disc pl-5 space-y-2 text-gray-700"></ul>
                </div>
                
                <!-- 重新测试按钮 -->
                <div class="text-center">
                    <button id="restart-btn" class="px-8 py-3 bg-secondary text-white rounded-lg hover:bg-secondary/90 transition-all-300 shadow-soft">
                        <i class="fa fa-refresh mr-2"></i>重新测试
                    </button>
                    <button id="change-test-btn" class="px-8 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all-300 mt-4">
                        <i class="fa fa-exchange mr-2"></i>更换测试类型
                    </button>
                </div>
            </div>
        </div>

        <!-- 原创声明 -->
        <div class="text-center text-sm text-gray-500 mt-12">
            <p>© 2025 心理状态自查工具 | 原创内容，未经授权不得转载</p>
            <p class="mt-2">本工具仅用于个人自我探索，不替代专业心理服务</p>
        </div>
    </div>

    <script>
        // 测试数据
        const testData = {
            social: {
                title: "社交焦虑自查",
                description: "了解你在社交场合中的焦虑程度和情绪状态",
                questions: [
                    {
                        text: "即使在非正式的聚会上，我也常感到紧张。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "与一群不认识的人在一起时，我通常感到不自在。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "在与一位异性交谈时我通常感到轻松。",
                        options: [
                            { text: "本条与我一点也不相符", value: 5 },
                            { text: "本条与我有一点儿相符", value: 4 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 2 },
                            { text: "本条与我极其相符", value: 1 }
                        ]
                    },
                    {
                        text: "在必须同老师或上司谈话时，我感到紧张。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "聚会常会使我感到焦虑及不自在。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "与大多数人相比，我在社会交往中可能较少羞怯。",
                        options: [
                            { text: "本条与我一点也不相符", value: 5 },
                            { text: "本条与我有一点儿相符", value: 4 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 2 },
                            { text: "本条与我极其相符", value: 1 }
                        ]
                    },
                    {
                        text: "在与我不太熟悉的同性谈话时，我常常感到紧张。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "在求职面试时我会紧张的。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "我希望自己在社交场合中信心更足一些。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "在社交场合中，我很少感到焦虑。",
                        options: [
                            { text: "本条与我一点也不相符", value: 5 },
                            { text: "本条与我有一点儿相符", value: 4 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 2 },
                            { text: "本条与我极其相符", value: 1 }
                        ]
                    },
                    {
                        text: "一般而言，我是一个害羞的人。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "在与一位迷人的异性交谈时我经常感到紧张。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "给不太熟的人打电话时我通常觉得紧张。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "我在与权威人士谈话时感到紧张。",
                        options: [
                            { text: "本条与我一点也不相符", value: 1 },
                            { text: "本条与我有一点儿相符", value: 2 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 4 },
                            { text: "本条与我极其相符", value: 5 }
                        ]
                    },
                    {
                        text: "即使处于一群和我相当不同的人群之中，通常我仍感到放松。",
                        options: [
                            { text: "本条与我一点也不相符", value: 5 },
                            { text: "本条与我有一点儿相符", value: 4 },
                            { text: "本条与我中等程度相符", value: 3 },
                            { text: "本条与我非常相符", value: 2 },
                            { text: "本条与我极其相符", value: 1 }
                        ]
                    }
                ],
                results: [
                    {
                        range: [15, 35],
                        title: "社交自信型",
                        description: "你在社交场合中通常感到自信和舒适。你能够自然地表达自己，与他人建立联系，并且不太担心他人的评价。这种状态有助于你在各种社交环境中都能游刃有余。",
                        suggestions: [
                            "继续保持你的社交自信，这是一项宝贵的能力。",
                            "可以尝试帮助那些在社交中感到困难的朋友，分享你的经验。",
                            "注意倾听他人，有时候过度自信可能会让人忽略他人的感受。"
                        ]
                    },
                    {
                        range: [36, 55],
                        title: "社交平衡型",
                        description: "你在社交场合中表现得比较平衡，有时会感到一定的紧张，但总体上能够应对各种社交情境。你对自己的社交能力有一定信心，但也会在意自己的表现。",
                        suggestions: [
                            "接受自己在社交中的偶尔紧张是正常的，大多数人都会有这种感受。",
                            "在重要社交场合前，可以做一些准备，增强信心。",
                            "尝试学习一些社交技巧，进一步提升你的社交能力。"
                        ]
                    },
                    {
                        range: [56, 75],
                        title: "社交敏感型",
                        description: "你在社交场合中经常感到紧张和不安，对他人的评价比较敏感。你可能会过度关注自己的表现，担心出错或给人不好的印象。这种状态可能会影响你的社交体验和生活质量。",
                        suggestions: [
                            "记住，大多数人都有自己的不安全感，不只是你一个人。",
                            "尝试逐步挑战自己的社交舒适区，从小范围社交开始。",
                            "学习一些放松技巧，如深呼吸、渐进性肌肉放松等，帮助缓解紧张情绪。",
                            "如果社交焦虑严重影响到你的生活，建议寻求专业心理咨询师的帮助。"
                        ]
                    }
                ]
            },
            behavioral: {
                title: "行为模式自查",
                description: "评估你在手机使用、游戏等日常行为方面的模式",
                questions: [
                    {
                        text: "你每天使用手机的时间大约是多少？",
                        options: [
                            { text: "少于2小时", value: 0 },
                            { text: "2-4小时", value: 1 },
                            { text: "4-6小时", value: 2 },
                            { text: "6小时以上", value: 3 }
                        ]
                    },
                    {
                        text: "当你感到无聊或不安时，你的第一反应是：",
                        options: [
                            { text: "寻找现实中的活动或爱好", value: 0 },
                            { text: "有时会看手机，但也能享受其他活动", value: 1 },
                            { text: "通常会拿起手机或玩游戏", value: 2 },
                            { text: "必须立即使用手机或玩游戏才能缓解", value: 3 }
                        ]
                    },
                    {
                        text: "你是否曾经因为使用手机或玩游戏而忽略了学习、工作或社交活动？",
                        options: [
                            { text: "从不", value: 0 },
                            { text: "偶尔", value: 1 },
                            { text: "经常", value: 2 },
                            { text: "几乎每天", value: 3 }
                        ]
                    },
                    {
                        text: "当你无法使用手机或玩游戏时（如手机没电、网络中断），你会感到：",
                        options: [
                            { text: "无所谓，能轻松应对", value: 0 },
                            { text: "有一点不便，但可以接受", value: 1 },
                            { text: "明显的不安和焦虑", value: 2 },
                            { text: "极度焦虑，无法忍受", value: 3 }
                        ]
                    },
                    {
                        text: "你是否曾经尝试减少手机使用或游戏时间，但难以坚持？",
                        options: [
                            { text: "没有，我能轻松控制使用时间", value: 0 },
                            { text: "有过，但能成功减少使用时间", value: 1 },
                            { text: "有过，尝试后又回到原来的使用模式", value: 2 },
                            { text: "有过多次尝试，但完全无法减少使用时间", value: 3 }
                        ]
                    },
                    {
                        text: "你在睡前使用手机或玩游戏的频率是：",
                        options: [
                            { text: "很少或从不", value: 0 },
                            { text: "偶尔", value: 1 },
                            { text: "经常", value: 2 },
                            { text: "几乎每天，并且经常熬夜", value: 3 }
                        ]
                    },
                    {
                        text: "你是否曾经因为使用手机或玩游戏而影响了睡眠质量？",
                        options: [
                            { text: "从不", value: 0 },
                            { text: "偶尔", value: 1 },
                            { text: "经常", value: 2 },
                            { text: "几乎每天", value: 3 }
                        ]
                    },
                    {
                        text: "你对手机消息或社交媒体通知的反应是：",
                        options: [
                            { text: "看到时才处理，不急于立即查看", value: 0 },
                            { text: "有时间就查看，但不会立即响应", value: 1 },
                            { text: "通常会立即查看并响应", value: 2 },
                            { text: "必须立即查看，否则会感到不安", value: 3 }
                        ]
                    },
                    {
                        text: "你是否曾经因为过度使用手机或游戏而出现身体不适（如眼睛疲劳、颈椎疼痛等）？",
                        options: [
                            { text: "从不", value: 0 },
                            { text: "偶尔", value: 1 },
                            { text: "经常", value: 2 },
                            { text: "几乎每天", value: 3 }
                        ]
                    },
                    {
                        text: "你认为自己的手机使用或游戏行为是否影响了你的人际关系？",
                        options: [
                            { text: "没有影响，我能平衡线上和线下关系", value: 0 },
                            { text: "有一点影响，但不严重", value: 1 },
                            { text: "有明显影响，减少了现实中的社交时间", value: 2 },
                            { text: "严重影响，几乎所有社交都在线上进行", value: 3 }
                        ]
                    }
                ],
                results: [
                    {
                        range: [0, 10],
                        title: "行为平衡型",
                        description: "你对手机和游戏的使用保持着健康的平衡。你能够控制自己的使用时间，不会让这些行为影响到你的日常生活、学习工作和人际关系。这种平衡的状态有助于你充分利用科技带来的便利，同时不会被其负面影响。",
                        suggestions: [
                            "继续保持这种健康的使用模式。",
                            "可以分享你的经验和方法，帮助他人建立健康的行为习惯。",
                            "定期反思自己的使用习惯，确保它们仍然符合你的生活目标。"
                        ]
                    },
                    {
                        range: [11, 20],
                        title: "行为关注型",
                        description: "你对手机和游戏的使用有一定的依赖，但还在可控范围内。有时你可能会过度使用，但总体上能够意识到并尝试调整。这种状态提示你需要更多关注自己的行为模式，以避免发展成更严重的问题。",
                        suggestions: [
                            "设定明确的使用界限，如特定时间段不使用手机。",
                            "寻找替代活动，特别是在感到无聊或不安时。",
                            "尝试使用手机应用的健康使用功能，如屏幕时间限制。",
                            "培养线下爱好和社交活动，丰富你的生活。"
                        ]
                    },
                    {
                        range: [21, 30],
                        title: "行为依赖型",
                        description: "你对手机或游戏的使用可能已经形成了较强的依赖。这种依赖可能已经开始影响你的日常生活、学习工作、睡眠质量和人际关系。这种状态需要你认真关注并采取积极措施来调整。",
                        suggestions: [
                            "考虑制定详细的使用计划，逐步减少使用时间。",
                            "寻求家人或朋友的支持和监督。",
                            "尝试数字断舍离，如定期进行无手机日或无手机时段。",
                            "如果自我调整困难，建议寻求专业心理咨询师的帮助。",
                            "关注自己使用手机或游戏的潜在心理需求，寻找更健康的方式来满足这些需求。"
                        ]
                    }
                ]
            }
        };

        // 全局变量
        let currentTest = null;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let timerInterval = null;
        let startTime = null;

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            // 绑定重新测试按钮事件
            document.getElementById('restart-btn').addEventListener('click', restartTest);
            document.getElementById('change-test-btn').addEventListener('click', changeTest);
            
            // 绑定上一题/下一题按钮事件
            document.getElementById('prev-btn').addEventListener('click', goToPreviousQuestion);
            document.getElementById('next-btn').addEventListener('click', goToNextQuestion);
        });

        // 开始测试
        function startTest(testType) {
            currentTest = testType;
            currentQuestionIndex = 0;
            userAnswers = new Array(testData[testType].questions.length).fill(null);
            
            // 显示问题区域，隐藏测试选择区域
            document.getElementById('test-selection').classList.add('hidden');
            document.getElementById('test-questions').classList.remove('hidden');
            document.getElementById('test-results').classList.add('hidden');
            
            // 显示第一题
            showQuestion(0);
            
            // 开始计时
            startTime = new Date();
            updateTimer();
            timerInterval = setInterval(updateTimer, 1000);
        }

        // 显示问题
        function showQuestion(index) {
            const question = testData[currentTest].questions[index];
            document.getElementById('question-text').textContent = question.text;
            
            // 更新进度
            document.getElementById('question-progress').textContent = `问题 ${index + 1}/${testData[currentTest].questions.length}`;
            document.getElementById('progress-bar').style.width = `${(index + 1) / testData[currentTest].questions.length * 100}%`;
            
            // 生成选项
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, i) => {
                const optionCard = document.createElement('div');
                optionCard.className = `option-card p-4 border rounded-lg cursor-pointer ${userAnswers[index] === i ? 'selected border-primary' : 'border-gray-200'}`;
                
                optionCard.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full border flex items-center justify-center mr-3 ${userAnswers[index] === i ? 'border-primary text-primary' : 'border-gray-300 text-gray-400'}">
                            ${userAnswers[index] === i ? '<i class="fa fa-check text-sm"></i>' : ''}
                        </div>
                        <span>${option.text}</span>
                    </div>
                `;
                
                optionCard.addEventListener('click', () => selectOption(i));
                optionsContainer.appendChild(optionCard);
            });
            
            // 更新导航按钮状态
            document.getElementById('prev-btn').disabled = index === 0;
            document.getElementById('next-btn').disabled = userAnswers[index] === null;
            document.getElementById('next-btn').textContent = index === testData[currentTest].questions.length - 1 ? '查看结果' : '下一题';
            document.getElementById('next-btn').innerHTML = index === testData[currentTest].questions.length - 1 ? '查看结果<i class="fa fa-arrow-right ml-2"></i>' : '下一题<i class="fa fa-arrow-right ml-2"></i>';
        }

        // 选择选项
        function selectOption(optionIndex) {
            userAnswers[currentQuestionIndex] = optionIndex;
            
            // 更新选项样式
            const options = document.querySelectorAll('.option-card');
            options.forEach((option, i) => {
                if (i === optionIndex) {
                    option.classList.add('selected', 'border-primary');
                    option.querySelector('.w-6').classList.add('border-primary', 'text-primary');
                    option.querySelector('.w-6').innerHTML = '<i class="fa fa-check text-sm"></i>';
                } else {
                    option.classList.remove('selected', 'border-primary');
                    option.querySelector('.w-6').classList.remove('border-primary', 'text-primary');
                    option.querySelector('.w-6').classList.add('border-gray-300', 'text-gray-400');
                    option.querySelector('.w-6').innerHTML = '';
                }
            });
            
            // 启用下一题按钮
            document.getElementById('next-btn').disabled = false;
        }

        // 上一题
        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion(currentQuestionIndex);
            }
        }

        // 下一题
        function goToNextQuestion() {
            if (currentQuestionIndex < testData[currentTest].questions.length - 1) {
                currentQuestionIndex++;
                showQuestion(currentQuestionIndex);
            } else {
                // 计算结果
                calculateResults();
            }
        }

        // 计算结果
        function calculateResults() {
            // 停止计时
            clearInterval(timerInterval);
            
            // 计算总分
            let totalScore = 0;
            userAnswers.forEach((answer, index) => {
                if (answer !== null) {
                    totalScore += testData[currentTest].questions[index].options[answer].value;
                }
            });
            
            // 查找对应的结果
            let result = null;
            testData[currentTest].results.forEach(r => {
                if (totalScore >= r.range[0] && totalScore <= r.range[1]) {
                    result = r;
                }
            });
            
            // 显示结果
            showResults(result, totalScore);
        }

        // 显示结果
        function showResults(result, score) {
            // 隐藏问题区域，显示结果区域
            document.getElementById('test-questions').classList.add('hidden');
            document.getElementById('test-results').classList.remove('hidden');
            
            // 更新结果标题
            document.getElementById('result-title').textContent = `${testData[currentTest].title} - ${result.title}`;
            
            // 更新结果文本
            document.getElementById('result-text').innerHTML = `
                <p>${result.description}</p>
                <p class="mt-4 text-center">您的得分：<span class="font-semibold text-primary">${score}</span> / 75</p>
            `;
            
            // 更新建议列表
            const suggestionsList = document.getElementById('suggestions-list');
            suggestionsList.innerHTML = '';
            result.suggestions.forEach(suggestion => {
                const li = document.createElement('li');
                li.textContent = suggestion;
                suggestionsList.appendChild(li);
            });
            
            // 生成结果图表
            generateResultChart(score);
            
            // 显示结果卡片动画
            setTimeout(() => {
                const resultCards = document.querySelectorAll('.result-card');
                resultCards.forEach((card, index) => {
                    setTimeout(() => {
                        card.classList.add('visible');
                    }, index * 200);
                });
            }, 100);
        }

        // 生成结果图表
        function generateResultChart(score) {
            const ctx = document.getElementById('result-chart').getContext('2d');
            
            // 销毁之前的图表（如果存在）
            if (window.resultChart) {
                window.resultChart.destroy();
            }
            
            // 创建新的图表
            window.resultChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['得分情况'],
                    datasets: [{
                        label: '您的得分',
                        data: [score],
                        backgroundColor: score <= 10 ? 'rgba(80, 200, 120, 0.6)' : 
                                        score <= 20 ? 'rgba(255, 205, 86, 0.6)' : 
                                        'rgba(255, 99, 132, 0.6)',
                        borderColor: score <= 10 ? 'rgb(80, 200, 120)' : 
                                    score <= 20 ? 'rgb(255, 205, 86)' : 
                                    'rgb(255, 99, 132)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 75,
                            ticks: {
                                stepSize: 5
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += context.parsed.y + '/75';
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        // 更新计时器
        function updateTimer() {
            if (!startTime) return;
            
            const now = new Date();
            const elapsedSeconds = Math.floor((now - startTime) / 1000);
            const minutes = Math.floor(elapsedSeconds / 60).toString().padStart(2, '0');
            const seconds = (elapsedSeconds % 60).toString().padStart(2, '0');
            
            document.getElementById('test-timer').textContent = `${minutes}:${seconds}`;
        }

        // 重新测试
        function restartTest() {
            startTest(currentTest);
        }

        // 更换测试类型
        function changeTest() {
            // 停止计时
            clearInterval(timerInterval);
            
            // 显示测试选择区域，隐藏其他区域
            document.getElementById('test-selection').classList.remove('hidden');
            document.getElementById('test-questions').classList.add('hidden');
            document.getElementById('test-results').classList.add('hidden');
        }
    </script>
</body>
</html>
